# Redis 安装
从官网下载对应的 redis 版本：

[redis 下载版本一览](https://download.redis.io/releases/?_gl=1*6zrsf6*_ga*MTcyNzYwMzIzLjE2NzcwNjc5NTU.*_ga_8BKGRQKRPV*MTY3NzA2Nzk1NC4xLjEuMTY3NzA2ODQwMC4xNS4wLjA.)

这里下载的 redis 版本是(5.0.6)。然后在 CentOS 解压：
```shell
# 解压 redis
tar -zxvf redis-5.0.6.tar.gz 
# 进入 redis 目录下进行编译，注意需要 gcc 编译器，没有就安装一下
cd redis-5.0.6
# 开始编译
make && make install
# 修改配置文件
vim redis.conf
```
# Redis 数据结构-应用场景
## String 字符串
### 字符串常见操作
```shell
set key value # 存入字符串键值对
mset key value key value……key value # 批量存储字符串键值对
setnx key value # 为不存在的键存入对应的值
get key # 获取一个字符串键值
mget key key……key # 批量获取字符串键值
del key key……key key # 批量删除键
expire key seconds # 设置一个键的过期时间(秒)

# 原子加减
incr key # 将 key 中存储的数字值加1
decr key # 将 key 中存储的数字值减1
incrby key increment # 将 key 所存储的值加上 increment
decrby key increment # 将
```
### 字符串应用场景
1. 单值缓存：`set zs zhangsanz`
2. 对象缓存：`set zs '{"name":"zhangsan"}'`
3. 分布式锁：`setnx product:10001 true` 返回 1 表示上锁成功，返回 0 表示上锁失败，业务完成后要释放锁。`set product:10001 true ex 10 nx` 
防止程序意外导致锁无法释放；
4. 计数器：文章阅读计数：`incr article:readcount:{文章id}`，获取文章阅读量：`get article:readcount:{文章id}`
5. Web集群session共享：spring session + redis 实现session共享；
6. 分布式系统全局序列号：`incrby orderId by`

## 哈希-hash

### Hash 常见操作
```shell
hset key field value # 存储一个哈希表key的键值
hsetnx key field value # 存储一个不存在的键的对应的值
hmset key field value field value……field value # 在一个哈希表中存储多个键值对
hget key field # 获取哈希表 key 对应的 field 的键值
hmget key field field……field # 批量获取hash表key中多个 field 键值
hdel key fild……field # 删除哈希表 key 中 field 键值
glen key # 返回哈希表 key 中 field 的数量
hgetall key # 返回哈希表key中所有的键值
hincrby by key field increment # 为哈希表 key 中 field 的键值加上增量 increment
```
### hash 应用场景
1. 对象缓存： `hmset user name zhansan age 18`
2. 电商购物车：用户为id为key，商品id为field，商品数量为value；

相比于 String 字符串，hash 可以归类数据，内存消耗比 String 小，存储比 String 更节省空间；其缺点是过期功能不能用在field上，只能作用在
key上；Redis 集群架构下不能大规模使用；(当 key 的属性有很多的时候，只能存在一个 redis 节点上，会导致这个节点压力比其他节点压力大很多)

## 列表 list
### list 常用操作
```shell
lpush key value……value # 将一个或多个值 value 插入到 key 列表的表头(最左边)
rpush key value……value # 将一个或多个值 value 插入到 key 列表的表尾(最右边)
LPOP key # 移除并返回 key 列表的头元素
RPOP key # 移除并返回 key 列表的尾元素
lrange key start stop # 返回列表 key 中指定区间内的元素
blpop key……key timeout #从key列表表头弹出一个元素，若列表中没有元素，阻塞等待 timeout 秒，若 timeout=0，则表示一直阻塞等待。
brpop key……key timeout #从key列表表尾弹出一个元素，若列表中没有元素，阻塞等待 timeout 秒，若 timeout=0，则表示一直阻塞等待。
```
### list 应用场景：
1. 消息队列；
2. 最新列表：如朋友圈点赞列表、评论列表；(适用于更新不那么频繁的业务场景)；
3. 排行榜：如销量、考生排名等(适用于定时计算，不适合实时计算)
## 集合 set
### set 常用操作
```shell
sadd key member……member # 往集合key 中存入元素，如果元素存在则忽略，反之则创建
srem key member……member # 从集合key中删除元素
smembers key # 获取集合key中所有元素
scard key # 获取集合key的元素个数
sismember  key  member //判断member元素是否存在于集合key中
spop  key  count				//从集合key中选出count个元素，元素从key中删除

Set运算操作
sinter  key……key 				//交集运算
sinterstore  destination  key……key		//将交集结果存入新集合destination中
sunion  key……key 				//并集运算
sunionstore  destination  key……key		//将并集结果存入新集合destination中
sdiff  key……key 				//差集运算
sdiffstore  destination  key……key		//将差集结果存入新集合destination中
```
### set 应用场景
1. 限时的抽奖活动：记录抽奖人数(`sadd key member`)，查看所有参见抽奖人员(`smembers key`), 随机选取 count 名中奖者(`srandmember key [count] / spop key [count]`);
2. 微信微博应用：点赞人员记录(`sadd key member`)，取消点赞(`srem key member`)

## 有序集合 zset
### zset 常用操作
```shell
zad key score member……score member	//往有序集合key中加入带分值元素
zrem key member……member		//从有序集合key中删除元素
zscore key member 			//返回有序集合key中元素member的分值
zincrby key increment member		//为有序集合key中元素member的分值加上increment 
zcard key				//返回有序集合key中元素个数
zrange key start stop withscores	//正序获取有序集合key从start下标到stop下标的元素
zrevrange key start stop withscores	//倒序获取有序集合key从start下标到stop下标的元素

Zset集合操作
zunionstore destkey numkeys key……key 	//并集计算
zinterstore destkey numkeys key……key	//交集计算
```

### zset 应用场景
1. 排行榜(天然的特性)；





